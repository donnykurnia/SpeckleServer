{"remainingRequest":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/thread-loader/dist/cjs.js!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/babel-loader/lib/index.js!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/src/views/Project.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/src/views/Project.vue","mtime":1609071089433},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _toConsumableArray from \"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.array.find\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport union from 'lodash.union';\nimport uniq from 'lodash.uniq';\nimport UserSearch from '../components/UserSearch.vue';\nimport PermissionTable from '../components/PermissionTableProject.vue';\nimport DetailDescription from '../components/DetailDescription.vue';\nimport ProjectDetailStreams from '../components/ProjectDetailStreams.vue';\nimport ProjectDetailTitle from '../components/ProjectDetailTitle.vue';\nimport ClientGraph from '../components/ClientGraph.vue';\nexport default {\n  name: 'ProjectDetailView',\n  components: {\n    UserSearch: UserSearch,\n    PermissionTable: PermissionTable,\n    DetailDescription: DetailDescription,\n    ProjectDetailStreams: ProjectDetailStreams,\n    ProjectDetailTitle: ProjectDetailTitle,\n    ClientGraph: ClientGraph\n  },\n  props: {},\n  computed: {\n    canEdit: function canEdit() {\n      return this.project.owner === this.$store.state.user._id || this.project.canWrite.indexOf(this.$store.state.user._id) > -1 || this.$store.state.user.role === 'admin';\n    },\n    project: function project() {\n      var _this = this;\n\n      return this.$store.state.projects.find(function (p) {\n        return p._id === _this.$route.params.projectId;\n      });\n    },\n    canReadProject: function canReadProject() {\n      return this.project.canRead;\n    },\n    canWriteProject: function canWriteProject() {\n      return this.project.canWrite;\n    },\n    canReadStreams: function canReadStreams() {\n      return this.project.permissions.canRead;\n    },\n    canWriteStreams: function canWriteStreams() {\n      return this.project.permissions.canWrite;\n    },\n    allUsers: function allUsers() {\n      return uniq([].concat(_toConsumableArray(this.canReadProject), _toConsumableArray(this.canWriteProject), _toConsumableArray(this.canReadStreams), _toConsumableArray(this.canWriteProject), [this.project.owner]));\n    }\n  },\n  data: function data() {\n    return {};\n  },\n  methods: {\n    restore: function restore() {\n      this.$store.dispatch('updateProject', {\n        _id: this.project._id,\n        deleted: false\n      });\n    },\n    addUserToTeam: function addUserToTeam(userId) {\n      this.$store.dispatch('addUserToProject', {\n        projectId: this.project._id,\n        userId: userId\n      });\n      return;\n    },\n    addStream: function addStream(streamId) {\n      this.$store.dispatch('addStreamToProject', {\n        projectId: this.project._id,\n        streamId: streamId\n      });\n      return;\n    },\n    removeStream: function removeStream(streamId) {\n      this.$store.dispatch('removeStreamFromProject', {\n        projectId: this.project._id,\n        streamId: streamId\n      });\n    }\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    var project = this.$store.state.projects.find(function (p) {\n      return p._id === _this2.$route.params.projectId;\n    });\n\n    if (!project) {\n      this.$store.dispatch('getProject', {\n        _id: this.$route.params.projectId\n      }).then(function (res) {\n        _this2.$store.dispatch('getUser', {\n          _id: res.data.resource.owner\n        });\n\n        union(res.data.resource.canRead, res.data.resource.canWrite).forEach(function (_id) {\n          return _this2.$store.dispatch('getUser', {\n            _id: _id\n          });\n        });\n      }).catch(function (err) {\n        if (_this2.$store.state.isAuth) {\n          _this2.$router.push('/projects');\n\n          console.log(\"you don't have permission.\");\n        } else {\n          console.log(\"should redirect to login\");\n\n          _this2.$router.push('/login');\n        }\n\n        console.log(err);\n      });\n    } else {\n      this.$store.dispatch('getUser', {\n        _id: project.owner\n      });\n      union(project.canRead, project.canWrite).forEach(function (_id) {\n        return _this2.$store.dispatch('getUser', {\n          _id: _id\n        });\n      });\n    }\n  }\n};",{"version":3,"sources":["Project.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <v-container grid-list-xl v-if='project'>\n    <v-toolbar absolute v-if='project.deleted'>\n      <span>This project is in your trashbin. </span>\n      <v-spacer></v-spacer>\n      <v-btn color='primary' v-if='canEdit' @click.native='restore'> Restore? </v-btn>\n    </v-toolbar>\n    <v-layout row wrap class='mb-3'>\n      <v-flex xs12>\n        <project-detail-title :project='project'></project-detail-title>\n      </v-flex>\n      <v-flex xs12>\n        <detail-description :resource='project'></detail-description>\n      </v-flex>\n      <v-flex xs12 sm12 lg12>\n        <v-card class='elevation-0'>\n          <v-card-title class='title font-weight-light'>\n            <v-icon small left>supervisor_account</v-icon>&nbsp;\n            Users\n          </v-card-title>\n          <v-card-text>\n            <user-search v-on:selected-user='addUserToTeam' v-if='canEdit'></user-search>\n            <permission-table :project='project' :global-disabled='!canEdit' @remove-user='' @move-user=''></permission-table>\n          </v-card-text>\n        </v-card>\n      </v-flex>\n      <v-flex xs12 sm12 lg12>\n        <v-card  class='elevation-0'>\n          <v-card-title class='title font-weight-light'>\n            <v-icon small left>import_export</v-icon>&nbsp;\n            Streams\n          </v-card-title>\n          <v-card-text>\n            <project-detail-streams :project='project' v-on:selected-stream='addStream' v-on:remove-stream='removeStream'></project-detail-streams>\n          </v-card-text>\n        </v-card>\n      </v-flex>\n      <v-flex xs12>\n        <client-graph :project='project'></client-graph>\n      </v-flex>\n    </v-layout>\n  </v-container>\n</template>\n<script>\nimport union from 'lodash.union'\nimport uniq from 'lodash.uniq'\n\nimport UserSearch from '../components/UserSearch.vue'\nimport PermissionTable from '../components/PermissionTableProject.vue'\nimport DetailDescription from '../components/DetailDescription.vue'\nimport ProjectDetailStreams from '../components/ProjectDetailStreams.vue'\nimport ProjectDetailTitle from '../components/ProjectDetailTitle.vue'\nimport ClientGraph from '../components/ClientGraph.vue'\n\nexport default {\n  name: 'ProjectDetailView',\n  components: {\n    UserSearch,\n    PermissionTable,\n    DetailDescription,\n    ProjectDetailStreams,\n    ProjectDetailTitle,\n    ClientGraph\n  },\n  props: {},\n  computed: {\n    canEdit( ) {\n      return this.project.owner === this.$store.state.user._id || this.project.canWrite.indexOf( this.$store.state.user._id ) > -1 || this.$store.state.user.role === 'admin'\n    },\n    project( ) {\n      return this.$store.state.projects.find( p => p._id === this.$route.params.projectId )\n    },\n    canReadProject( ) { return this.project.canRead },\n    canWriteProject( ) { return this.project.canWrite },\n    canReadStreams( ) { return this.project.permissions.canRead },\n    canWriteStreams( ) { return this.project.permissions.canWrite },\n    allUsers( ) {\n      return uniq( [ ...this.canReadProject, ...this.canWriteProject, ...this.canReadStreams, ...this.canWriteProject, this.project.owner ] )\n    }\n  },\n  data( ) {\n    return {}\n  },\n  methods: {\n    restore( ) {\n      this.$store.dispatch( 'updateProject', { _id: this.project._id, deleted: false } )\n    },\n    addUserToTeam( userId ) {\n      this.$store.dispatch( 'addUserToProject', { projectId: this.project._id, userId: userId } )\n      return\n    },\n    addStream( streamId ) {\n      this.$store.dispatch( 'addStreamToProject', { projectId: this.project._id, streamId: streamId } )\n      return\n    },\n    removeStream( streamId ) {\n      this.$store.dispatch( 'removeStreamFromProject', { projectId: this.project._id, streamId: streamId } )\n    },\n  },\n  mounted( ) {\n    let project = this.$store.state.projects.find( p => p._id === this.$route.params.projectId )\n    if ( !project ) {\n      this.$store.dispatch( 'getProject', { _id: this.$route.params.projectId } )\n        .then( res => {\n          this.$store.dispatch( 'getUser', { _id: res.data.resource.owner } )\n          union( res.data.resource.canRead, res.data.resource.canWrite ).forEach( _id => this.$store.dispatch( 'getUser', { _id: _id } ) )\n        } )\n        .catch( err => {\n          if ( this.$store.state.isAuth ) {\n            this.$router.push( '/projects' )\n            console.log( \"you don't have permission.\" )\n          } else {\n            console.log( \"should redirect to login\" )\n            this.$router.push( '/login' )\n          }\n          console.log( err )\n        } )\n    } else {\n      this.$store.dispatch( 'getUser', { _id: project.owner } )\n      union( project.canRead, project.canWrite ).forEach( _id => this.$store.dispatch( 'getUser', { _id: _id } ) )\n    }\n  }\n}\n\n</script>\n<style scoped lang='scss'>\n.detail-card {\n  margin-bottom: 20px;\n}\n\n</style>\n"],"sourceRoot":"src/views"}]}