{"remainingRequest":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/thread-loader/dist/cjs.js!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/babel-loader/lib/index.js!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/src/store/utilities.js","dependencies":[{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/src/store/utilities.js","mtime":1609071089429},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _typeof from \"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/@babel/runtime-corejs2/helpers/esm/typeof\";\nimport _Array$isArray from \"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/@babel/runtime-corejs2/core-js/array/is-array\";\nexport var removeArraysRecursive = function removeArraysRecursive(foo) {\n  var bar = {};\n\n  for (var key in foo) {\n    if (!foo.hasOwnProperty(key)) continue;else if (_Array$isArray(foo[key])) {//bar[ key + ' (array)' ] = `Array with ${ foo[key].length } elements`\n    } else if (_typeof(foo[key]) === 'object' && foo[key] !== null) {\n      bar[key] = removeArraysRecursive(foo[key]);\n    } else {\n      bar[key] = foo[key];\n    }\n  }\n\n  return bar;\n};\nexport var getStructuralArrPropKeys = function getStructuralArrPropKeys(foo) {\n  var bar = {};\n\n  for (var key in foo) {\n    if (!foo.hasOwnProperty(key)) continue;else if (_Array$isArray(foo[key])) {\n      bar[key] = \"Array with \".concat(foo[key].length, \" elements\");\n    } else if (_typeof(foo[key]) === 'object' && foo[key] !== null) {\n      bar[key] = getStructuralArrPropKeys(foo[key]);\n    }\n  }\n\n  return bar;\n};\nexport var getTokenMSAL =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee(_ref) {\n    var clientId, authority, loginRequest, userAgent, token;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            clientId = _ref.clientId, authority = _ref.authority, loginRequest = _ref.loginRequest;\n            // TODO: THIS CANNOT BE CALLED MULTIPLE TIMES!!!\n            // DEPENDS ON LOCAL STORAGE TO PROPERLY OBTAIN CLIENTID\n            userAgent = new Msal.UserAgentApplication({\n              auth: {\n                clientId: clientId,\n                authority: authority,\n                redirectUri: window.location.origin + \"/msal.html\"\n              },\n              cache: {\n                cacheLocation: \"localStorage\",\n                storeAuthStateInCookie: true\n              }\n            });\n            _context.next = 4;\n            return userAgent.getCachedToken(clientId);\n\n          case 4:\n            token = _context.sent;\n\n            if (!token) {\n              _context.next = 7;\n              break;\n            }\n\n            return _context.abrupt(\"return\", token.accessToken);\n\n          case 7:\n            _context.prev = 7;\n            _context.next = 10;\n            return userAgent.acquireTokenSilent(loginRequest);\n\n          case 10:\n            token = _context.sent;\n            _context.next = 32;\n            break;\n\n          case 13:\n            _context.prev = 13;\n            _context.t0 = _context[\"catch\"](7);\n            console.log('MSAL Error: ' + _context.t0.errorCode);\n\n            if (!(_context.t0.errorCode === \"user_login_error\")) {\n              _context.next = 26;\n              break;\n            }\n\n            window.localStorage.msalClientId = clientId;\n            _context.next = 20;\n            return userAgent.loginPopup(loginRequest);\n\n          case 20:\n            delete window.localStorage.msalClientId;\n            _context.next = 23;\n            return getTokenMSAL({\n              clientId: clientId,\n              authority: authority,\n              loginRequest: loginRequest\n            });\n\n          case 23:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 26:\n            if (!(_context.t0.errorCode === \"token_renewal_error\")) {\n              _context.next = 32;\n              break;\n            }\n\n            window.localStorage.msalClientId = clientId;\n            _context.next = 30;\n            return userAgent.acquireTokenPopup(loginRequest);\n\n          case 30:\n            token = _context.sent;\n            delete window.localStorage.msalClientId;\n\n          case 32:\n            return _context.abrupt(\"return\", token.accessToken);\n\n          case 33:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[7, 13]]);\n  }));\n\n  return function getTokenMSAL(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();",{"version":3,"sources":["/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/src/store/utilities.js"],"names":["removeArraysRecursive","foo","bar","key","hasOwnProperty","getStructuralArrPropKeys","length","getTokenMSAL","clientId","authority","loginRequest","userAgent","Msal","UserAgentApplication","auth","redirectUri","window","location","origin","cache","cacheLocation","storeAuthStateInCookie","getCachedToken","token","accessToken","acquireTokenSilent","console","log","errorCode","localStorage","msalClientId","loginPopup","acquireTokenPopup"],"mappings":"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","sourcesContent":["export const removeArraysRecursive = ( foo ) => {\n  let bar = {}\n\n  for ( let key in foo ) {\n    if ( !foo.hasOwnProperty( key ) ) continue\n    else if ( Array.isArray( foo[ key ] ) ) {\n      //bar[ key + ' (array)' ] = `Array with ${ foo[key].length } elements`\n    } else if ( typeof foo[ key ] === 'object' && foo[ key ] !== null ) {\n      bar[ key ] = removeArraysRecursive( foo[ key ] )\n    } else {\n      bar[ key ] = foo[ key ]\n    }\n  }\n  return bar\n}\n\nexport const getStructuralArrPropKeys = ( foo ) => {\n  let bar = {}\n\n  for ( let key in foo ) {\n    if ( !foo.hasOwnProperty( key ) ) continue\n    else if ( Array.isArray( foo[ key ] ) ) {\n      bar[ key ] = `Array with ${ foo[key].length } elements`\n    } else if ( typeof foo[ key ] === 'object' && foo[ key ] !== null ) {\n      bar[ key ] = getStructuralArrPropKeys( foo[ key ] )\n    }\n  }\n  return bar\n}\n\nexport const getTokenMSAL = async ( { clientId, authority, loginRequest } ) => {\n  // TODO: THIS CANNOT BE CALLED MULTIPLE TIMES!!!\n  // DEPENDS ON LOCAL STORAGE TO PROPERLY OBTAIN CLIENTID\n  var userAgent = new Msal.UserAgentApplication( {\n    auth: {\n      clientId: clientId,\n      authority: authority,\n      redirectUri: window.location.origin + \"/msal.html\"\n    },\n    cache: {\n      cacheLocation: \"localStorage\",\n      storeAuthStateInCookie: true\n    },\n  } )\n\n  var token = await userAgent.getCachedToken( clientId )\n\n  if ( token )\n    return token.accessToken\n\n  try {\n    token = await userAgent.acquireTokenSilent( loginRequest )\n  } catch ( e ) {\n    console.log( 'MSAL Error: ' + e.errorCode )\n    if ( e.errorCode === \"user_login_error\" ) {\n      window.localStorage.msalClientId = clientId\n      await userAgent.loginPopup( loginRequest )\n      delete window.localStorage.msalClientId\n      return await getTokenMSAL( { clientId: clientId, authority: authority, loginRequest: loginRequest } )\n    } else if ( e.errorCode === \"token_renewal_error\" ) {\n      window.localStorage.msalClientId = clientId\n      token = await userAgent.acquireTokenPopup( loginRequest )\n      delete window.localStorage.msalClientId\n    }\n  }\n\n  return token.accessToken\n}\n"]}]}