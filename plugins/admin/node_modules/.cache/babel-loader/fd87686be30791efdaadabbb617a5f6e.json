{"remainingRequest":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/thread-loader/dist/cjs.js!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/babel-loader/lib/index.js!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/src/components/StreamDetailUserPerms.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/src/components/StreamDetailUserPerms.vue","mtime":1609071089415},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Set from \"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/@babel/runtime-corejs2/core-js/set\";\nimport _toConsumableArray from \"/Users/donnykurnia/data/Projects/upwork/3dbyggeri/glasshouse/SpeckleServer/plugins/admin/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport debounce from 'lodash.debounce';\nimport uniq from 'lodash.uniq';\nimport Axios from 'axios';\nimport UserSearch from './UserSearch.vue';\nimport PermissionTable from './PermissionTable.vue';\nexport default {\n  name: 'StreamDetailUserPerms',\n  components: {\n    UserSearch: UserSearch,\n    PermissionTable: PermissionTable\n  },\n  props: {\n    stream: Object\n  },\n  computed: {\n    streamOwner: function streamOwner() {\n      var _this = this;\n\n      if (this.isOwner) return \"\".concat(this.$store.state.user.name, \" \").concat(this.$store.state.user.surname);\n      var owner = this.$store.state.users.find(function (user) {\n        return user._id === _this.stream.owner;\n      });\n      if (!owner) return '(loading)';\n      return \"\".concat(owner.name, \" \").concat(owner.surname, \" \").concat(owner.company ? \"(\" + owner.company + \")\" : '');\n    },\n    canEdit: function canEdit() {\n      if (this.$store.state.user.role == 'admin') return true;\n      return this.isOwner ? true : this.stream.canWrite.indexOf(this.$store.state.user._id) !== -1;\n    },\n    isOwner: function isOwner() {\n      return this.stream.owner === this.$store.state.user._id;\n    },\n    usersFromProjects: function usersFromProjects() {\n      var _this2 = this,\n          _Array$prototype,\n          _Array$prototype2;\n\n      var otherProjects = this.$store.state.projects.filter(function (p) {\n        return p.streams.indexOf(_this2.stream.streamId) !== -1;\n      });\n\n      var otherCanRead = (_Array$prototype = Array.prototype).concat.apply(_Array$prototype, _toConsumableArray(otherProjects.map(function (op) {\n        return op.permissions.canRead;\n      })));\n\n      var otherCanWrite = (_Array$prototype2 = Array.prototype).concat.apply(_Array$prototype2, _toConsumableArray(otherProjects.map(function (op) {\n        return op.permissions.canWrite;\n      })));\n\n      return _toConsumableArray(new _Set([].concat(_toConsumableArray(otherCanWrite), _toConsumableArray(otherCanRead))));\n    },\n    streamProjects: function streamProjects() {\n      var _this3 = this;\n\n      return this.$store.state.projects.filter(function (p) {\n        return p.streams.indexOf(_this3.stream.streamId) !== -1;\n      });\n    }\n  },\n  data: function data() {\n    return {\n      userSearch: '',\n      foundUsers: [],\n      searchInProgress: false\n    };\n  },\n  methods: {\n    changeLinkSharing: function changeLinkSharing() {\n      this.$store.dispatch('updateStream', {\n        streamId: this.stream.streamId,\n        private: !this.stream.private\n      });\n    },\n    addUserToWrite: function addUserToWrite(userId) {\n      var canWrite = uniq([].concat(_toConsumableArray(this.stream.canWrite), [userId]));\n      this.$store.dispatch('updateStream', {\n        streamId: this.stream.streamId,\n        canWrite: canWrite\n      });\n    },\n    updatePerms: function updatePerms(_ref) {\n      var canRead = _ref.canRead,\n          canWrite = _ref.canWrite;\n      this.$store.dispatch('updateStream', {\n        streamId: this.stream.streamId,\n        canRead: canRead,\n        canWrite: canWrite\n      });\n    }\n  }\n};",{"version":3,"sources":["StreamDetailUserPerms.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <v-card class='elevation-0'>\n    <v-toolbar class='elevation-0 transparent'>\n      <v-icon small left>share</v-icon>&nbsp;\n      <span class='title font-weight-light'>Link Sharing</span> &nbsp;\n    </v-toolbar>\n    <v-divider></v-divider>\n    <v-card-text class='mx-2'>\n      <v-btn depressed color='primary' @click.native='changeLinkSharing' :disabled='!canEdit'>{{stream.private ? \"OFF\" : \"ON\"}}</v-btn>\n      {{ stream.private ? \"Private resource. Only people with read or write persmissions can access it.\" : \"Public resource. Anyone with the id can access it.\"}}\n      <span class='' v-if='isOwner'>\n        You are the <strong>owner</strong> of this stream.\n      </span>\n      <span class='' v-else>\n        This stream was shared with you by <strong>{{streamOwner}}.</strong>\n      </span>\n    </v-card-text>\n    <!-- <v-divider></v-divider> -->\n    <v-toolbar class='elevation-0 transparent title font-weight-light'>\n      <v-icon small left>supervisor_account</v-icon>&nbsp;\n      <span class='title font-weight-light'>User Permissions</span> &nbsp;\n    </v-toolbar>\n    <v-card-text class='mx-2' v-if='streamProjects.length>0'>\n      <span>Some users might be disabled as their permissions are set through the following projects: <router-link v-for='(proj, index) in streamProjects' :to='\"/projects/\"+proj._id' :key='proj._id'>{{proj.name}}<span v-if='index<streamProjects.length-1'>, </span></router-link></span>\n    </v-card-text>\n    <v-card-text class='mx-2' v-if='!canEdit'>\n      You cannot edit the permissions of this stream.\n    </v-card-text>\n    <v-divider></v-divider>\n    <v-card-text class='' v-if='canEdit'>\n      <user-search v-on:selected-user='addUserToWrite'></user-search>\n      <permission-table :resource='stream' :disabled-users='usersFromProjects' :global-disabled='!canEdit' v-on:update-table='updatePerms'></permission-table>\n    </v-card-text>\n  </v-card>\n</template>\n<script>\nimport debounce from 'lodash.debounce'\nimport uniq from 'lodash.uniq'\nimport Axios from 'axios'\n\nimport UserSearch from './UserSearch.vue'\nimport PermissionTable from './PermissionTable.vue'\n\nexport default {\n  name: 'StreamDetailUserPerms',\n  components: {\n    UserSearch,\n    PermissionTable\n  },\n  props: {\n    stream: Object\n  },\n  computed: {\n    streamOwner( ) {\n      if ( this.isOwner ) return `${this.$store.state.user.name} ${this.$store.state.user.surname}`\n      let owner = this.$store.state.users.find( user => user._id === this.stream.owner )\n      if ( !owner ) return '(loading)'\n      return `${owner.name} ${owner.surname} ${owner.company ? \"(\" + owner.company + \")\" : ''}`\n    },\n    canEdit( ) {\n      if (this.$store.state.user.role == 'admin') return true\n      return this.isOwner ? true : this.stream.canWrite.indexOf( this.$store.state.user._id ) !== -1\n    },\n    isOwner( ) {\n      return this.stream.owner === this.$store.state.user._id\n    },\n    usersFromProjects( ) {\n      let otherProjects = this.$store.state.projects.filter( p => p.streams.indexOf( this.stream.streamId ) !== -1 )\n      let otherCanRead = Array.prototype.concat( ...otherProjects.map( op => op.permissions.canRead ) )\n      let otherCanWrite = Array.prototype.concat( ...otherProjects.map( op => op.permissions.canWrite ) )\n      return [ ...new Set( [ ...otherCanWrite, ...otherCanRead ] ) ]\n    },\n    streamProjects( ) {\n      return this.$store.state.projects.filter( p => p.streams.indexOf( this.stream.streamId ) !== -1 )\n    }\n\n  },\n  data( ) {\n    return {\n      userSearch: '',\n      foundUsers: [ ],\n      searchInProgress: false\n    }\n  },\n  methods: {\n    changeLinkSharing( ) {\n      this.$store.dispatch( 'updateStream', { streamId: this.stream.streamId, private: !this.stream.private } )\n    },\n    addUserToWrite( userId ) {\n      let canWrite = uniq( [ ...this.stream.canWrite, userId ] )\n      this.$store.dispatch( 'updateStream', { streamId: this.stream.streamId, canWrite: canWrite } )\n    },\n    updatePerms( { canRead, canWrite } ) {\n      this.$store.dispatch( 'updateStream', { streamId: this.stream.streamId, canRead: canRead, canWrite: canWrite } )\n    }\n  }\n}\n\n</script>\n<style scoped lang='scss'>\n</style>\n"],"sourceRoot":"src/components"}]}